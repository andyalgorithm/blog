(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{334:function(s,t){s.exports="data:image/jpeg;base64,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"},335:function(s,t,a){s.exports=a.p+"assets/img/docker-y-6.163457a7.png"},419:function(s,t,a){"use strict";a.r(t);var n=a(14),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"docker基础-docker网络使用和配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker基础-docker网络使用和配置"}},[s._v("#")]),s._v(" Docker基础 - Docker网络使用和配置")]),s._v(" "),t("blockquote",[t("p",[s._v("上文已经向你介绍了，web容器创建和容器互联了，但是容器之间为什么可以直接通信？主机和容器之间为何可以通信？如何进行自定义的配置呢？所以这节就是我们要讲述的Docker网络。@pdai")])]),s._v(" "),t("ul",[t("li",[s._v("Docker基础 - Docker网络使用和配置\n"),t("ul",[t("li",[s._v("单机中docker网络\n"),t("ul",[t("li",[t("a",{attrs:{href:"#%E7%90%86%E8%A7%A3docker-%E9%BB%98%E8%AE%A4%E7%BD%91%E6%A1%A5"}},[s._v("理解Docker 默认网桥")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E7%90%86%E8%A7%A3%E5%AE%B9%E5%99%A8%E5%88%9B%E5%BB%BA%E6%97%B6%E7%9A%84ip%E5%88%86%E9%85%8D"}},[s._v("理解容器创建时的IP分配")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E7%90%86%E8%A7%A3%E5%AE%B9%E5%99%A8%E5%92%8Cdocker0%E7%9A%84%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1%E7%9A%84%E9%85%8D%E5%AF%B9"}},[s._v("理解容器和docker0的虚拟网卡的配对")])])])]),s._v(" "),t("li",[s._v("多物理机之间互联\n"),t("ul",[t("li",[t("a",{attrs:{href:"#%E6%8B%93%E6%89%91%E5%9B%BE"}},[s._v("拓扑图")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#ubuntu-%E7%A4%BA%E4%BE%8B"}},[s._v("ubuntu 示例")])])])])])])]),s._v(" "),t("h2",{attrs:{id:"单机中docker网络"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#单机中docker网络"}},[s._v("#")]),s._v(" "),t("a",{attrs:{href:"#%E5%8D%95%E6%9C%BA%E4%B8%ADdocker%E7%BD%91%E7%BB%9C"}},[s._v("#")]),s._v(" 单机中docker网络")]),s._v(" "),t("h3",{attrs:{id:"理解docker-默认网桥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#理解docker-默认网桥"}},[s._v("#")]),s._v(" "),t("a",{attrs:{href:"#%E7%90%86%E8%A7%A3docker-%E9%BB%98%E8%AE%A4%E7%BD%91%E6%A1%A5"}},[s._v("#")]),s._v(" 理解Docker 默认网桥")]),s._v(" "),t("blockquote",[t("p",[s._v("为何上文的例子中，容器之间通过--link就可以相互通信，主机和容器之间也能通信？")])]),s._v(" "),t("p",[s._v("在你安装Docker 服务默认会创建一个 docker0 网桥（其上有一个 docker0 内部接口），它在内核层连通了其他的物理或虚拟网卡，这就将所有容器和本地主机都放到同一个物理网络。")]),s._v(" "),t("p",[s._v("我们可用 docker network ls 命令查看：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network ls")]),s._v("\nNETWORK ID          NAME                DRIVER              SCOPE\nb8c5abdb0bec        bridge              bridge              "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n84e86bc93121        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("                "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("                "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n8e521527a897        none                null                "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n")])])]),t("p",[s._v("Docker 安装时会自动在 host 上创建三个网络：none，host，和bridge。我们看下docker0 网桥：(brctl可以通过yum install bridge-utils安装)")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# brctl show")]),s._v("\nbridge name     bridge "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("               STP enabled     interfaces\ndocker0         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(".0242703f9d02       no              veth0004826\n                                                        veth4ad3278\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ip a")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(": lo: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("LOOPBACK,UP,LOWER_UP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v(" qdisc noqueue state UNKNOWN group default qlen "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1/8 scope "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" lo\n       valid_lft forever preferred_lft forever\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(": eth0: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("BROADCAST,MULTICAST,UP,LOWER_UP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc pfifo_fast state UP group default qlen "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n    link/ether 00:16:3e:08:c1:ea brd ff:ff:ff:ff:ff:ff\n    inet "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.31")]),s._v(".165.194/20 brd "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.31")]),s._v(".175.255 scope global dynamic eth0\n       valid_lft 310072401sec preferred_lft 310072401sec\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(": docker0: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("BROADCAST,MULTICAST,UP,LOWER_UP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc noqueue state UP group default\n    link/ether 02:42:70:3f:9d:02 brd ff:ff:ff:ff:ff:ff\n    inet "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.1/16 brd "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".255.255 scope global docker0\n       valid_lft forever preferred_lft forever\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("45")]),s._v(": veth4ad3278@if44: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("BROADCAST,MULTICAST,UP,LOWER_UP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc noqueue master docker0 state UP group default\n    link/ether c2:77:e4:ea:f1:33 brd ff:ff:ff:ff:ff:ff link-netnsid "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("49")]),s._v(": veth0004826@if48: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("BROADCAST,MULTICAST,UP,LOWER_UP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc noqueue master docker0 state UP group default\n    link/ether 6e:c9:1a:7c:18:b1 brd ff:ff:ff:ff:ff:ff link-netnsid "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ip route")]),s._v("\ndefault via "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.31")]),s._v(".175.253 dev eth0\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("169.254")]),s._v(".0.0/16 dev eth0 scope "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v(" metric "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1002")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.0/16 dev docker0 proto kernel scope "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v(" src "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.1\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.31")]),s._v(".160.0/20 dev eth0 proto kernel scope "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v(" src "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.31")]),s._v(".165.194\n")])])]),t("p",[s._v("再用docker network inspect指令查看bridge网络：其Gateway就是网卡/接口docker0的IP地址：172.17.0.1。")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network inspect bridge")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bridge"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"b8c5abdb0becacfa1bfa1d72e2e663fb0157b62a9b8bee37e2607211722713cc"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Created"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2020-02-17T14:10:10.424119543+08:00"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scope"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bridge"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EnableIPv6"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPAM"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null,\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Config"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Subnet"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.17.0.0/16"')]),s._v(",\n                    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Gateway"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.17.0.1"')]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Internal"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Attachable"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Ingress"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ConfigFrom"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Network"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ConfigOnly"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Containers"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1cbc9aeba2a8a826d460ecb49de17ddf8ac336e150c752a3c762fd38a3e15254"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"web"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EndpointID"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"adb47ed0c60c6b80a442c71a5f35d63378cecca9598e0cef8409a6719552f4c2"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MacAddress"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"02:42:ac:11:00:03"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv4Address"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.17.0.3/16"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv6Address"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"d992e3c761e00649eb436b88c737adc54093b76119af0fb7878596b523f743ca"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"db"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EndpointID"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6a3dab5c545dd26e0ca6e36d928a32fd0a6197c8dbf4eeb718a4560e219575ed"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MacAddress"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"02:42:ac:11:00:02"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv4Address"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.17.0.2/16"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv6Address"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.bridge.default_bridge"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.bridge.enable_icc"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.bridge.enable_ip_masquerade"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.bridge.host_binding_ipv4"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.0.0.0"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.bridge.name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker0"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.driver.mtu"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1500"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Labels"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("p",[s._v("从上面你可以看到bridge的配置信息和容器信息。")]),s._v(" "),t("h3",{attrs:{id:"理解容器创建时的ip分配"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#理解容器创建时的ip分配"}},[s._v("#")]),s._v(" "),t("a",{attrs:{href:"#%E7%90%86%E8%A7%A3%E5%AE%B9%E5%99%A8%E5%88%9B%E5%BB%BA%E6%97%B6%E7%9A%84ip%E5%88%86%E9%85%8D"}},[s._v("#")]),s._v(" 理解容器创建时的IP分配")]),s._v(" "),t("blockquote",[t("p",[s._v("为了理解容器创建时的IP分配，这里需要清理所有已经启动的环境，然后再启动容器，看前后对比")])]),s._v(" "),t("ul",[t("li",[s._v("我们"),t("strong",[s._v("清理所有容器")]),s._v("实例，下面展示的就是docker安装之后的, 注意和上面的对比下：")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -a")]),s._v("\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network ls")]),s._v("\nNETWORK ID          NAME                DRIVER              SCOPE\nb8c5abdb0bec        bridge              bridge              "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n84e86bc93121        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("                "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("                "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n8e521527a897        none                null                "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network inspect bridge")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bridge"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"b8c5abdb0becacfa1bfa1d72e2e663fb0157b62a9b8bee37e2607211722713cc"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Created"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2020-02-17T14:10:10.424119543+08:00"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scope"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bridge"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EnableIPv6"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPAM"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null,\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Config"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Subnet"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.17.0.0/16"')]),s._v(",\n                    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Gateway"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.17.0.1"')]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Internal"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Attachable"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Ingress"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ConfigFrom"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Network"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ConfigOnly"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Containers"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.bridge.default_bridge"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.bridge.enable_icc"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.bridge.enable_ip_masquerade"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.bridge.host_binding_ipv4"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.0.0.0"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.bridge.name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker0"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.driver.mtu"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1500"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Labels"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ip a")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(": lo: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("LOOPBACK,UP,LOWER_UP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v(" qdisc noqueue state UNKNOWN group default qlen "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1/8 scope "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" lo\n       valid_lft forever preferred_lft forever\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(": eth0: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("BROADCAST,MULTICAST,UP,LOWER_UP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc pfifo_fast state UP group default qlen "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n    link/ether 00:16:3e:08:c1:ea brd ff:ff:ff:ff:ff:ff\n    inet "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.31")]),s._v(".165.194/20 brd "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.31")]),s._v(".175.255 scope global dynamic eth0\n       valid_lft 310069965sec preferred_lft 310069965sec\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(": docker0: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("NO-CARRIER,BROADCAST,MULTICAST,UP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc noqueue state DOWN group default\n    link/ether 02:42:70:3f:9d:02 brd ff:ff:ff:ff:ff:ff\n    inet "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.1/16 brd "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".255.255 scope global docker0\n       valid_lft forever preferred_lft forever\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# brctl show")]),s._v("\nbridge name     bridge "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("               STP enabled     interfaces\ndocker0         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(".0242703f9d02       no\n")])])]),t("ul",[t("li",[t("strong",[s._v("创建容器")])])]),s._v(" "),t("p",[s._v("Docker 在创建一个容器的时候，会执行如下操作：")]),s._v(" "),t("ul",[t("li",[s._v("创建一对虚拟接口/网卡，也就是veth pair，分别放到本地主机和新容器中；")]),s._v(" "),t("li",[s._v("本地主机一端桥接到默认的 docker0 或指定网桥上，并具有一个唯一的名字，如 vethxxxxx；")]),s._v(" "),t("li",[s._v("容器一端放到新容器中，并修改名字作为 eth0，这个网卡/接口只在容器的名字空间可见；")]),s._v(" "),t("li",[s._v("从网桥可用地址段中（也就是与该bridge对应的network）获取一个空闲地址分配给容器的 eth0，并配置默认路由到桥接网卡 vethxxxx。")])]),s._v(" "),t("p",[s._v("让我们启动一个容器，看下变化：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d --name db training/postgres")]),s._v("\n0ffd1092cd962bdbe335ce042b93d0f2082559600cacc82bbef40b8b66395e57\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# brctl show")]),s._v("\nbridge name     bridge "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("               STP enabled     interfaces\ndocker0         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(".0242703f9d02       no              vethd93e2ad\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ip a | grep vethd93e2ad")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("51")]),s._v(": vethd93e2ad@if50: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("BROADCAST,MULTICAST,UP,LOWER_UP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc noqueue master docker0 state UP group default\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network inspect bridge")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bridge"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"b8c5abdb0becacfa1bfa1d72e2e663fb0157b62a9b8bee37e2607211722713cc"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Created"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2020-02-17T14:10:10.424119543+08:00"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scope"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bridge"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EnableIPv6"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPAM"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null,\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Config"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Subnet"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.17.0.0/16"')]),s._v(",\n                    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Gateway"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.17.0.1"')]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Internal"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Attachable"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Ingress"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ConfigFrom"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Network"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ConfigOnly"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Containers"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0ffd1092cd962bdbe335ce042b93d0f2082559600cacc82bbef40b8b66395e57"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"db"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EndpointID"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a90cb50031effc99b9254fe4f1231bfbac8c4bb23d94c5a1425c1e116ac452dc"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MacAddress"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"02:42:ac:11:00:02"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv4Address"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.17.0.2/16"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"IPv6Address"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.bridge.default_bridge"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.bridge.enable_icc"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.bridge.enable_ip_masquerade"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.bridge.host_binding_ipv4"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.0.0.0"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.bridge.name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker0"')]),s._v(",\n            "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"com.docker.network.driver.mtu"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1500"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Labels"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("p",[s._v("如果不指定--network，创建的容器默认都会挂到 docker0 上，使用本地主机上 docker0 接口的 IP 作为所有容器的默认网关")]),s._v(" "),t("p",[s._v("当有多个容器创建后，容器网络拓扑结构如下：")]),s._v(" "),t("p",[t("img",{attrs:{src:a(334),alt:"img"}})]),s._v(" "),t("h3",{attrs:{id:"理解容器和docker0的虚拟网卡的配对"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#理解容器和docker0的虚拟网卡的配对"}},[s._v("#")]),s._v(" "),t("a",{attrs:{href:"#%E7%90%86%E8%A7%A3%E5%AE%B9%E5%99%A8%E5%92%8Cdocker0%E7%9A%84%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1%E7%9A%84%E9%85%8D%E5%AF%B9"}},[s._v("#")]),s._v(" 理解容器和docker0的虚拟网卡的配对")]),s._v(" "),t("blockquote",[t("p",[s._v("在上图中容器中eth0是怎么和host中虚拟网卡配对上的呢？")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -a")]),s._v("\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES\n0ffd1092cd96        training/postgres   "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"su postgres -c \'/us…"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" minutes ago      Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" minutes       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5432")]),s._v("/tcp            db\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it 0ffd1092cd96 /bin/bash")]),s._v("\nroot@0ffd1092cd96:/"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ip a")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(": lo: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("LOOPBACK,UP,LOWER_UP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65536")]),s._v(" qdisc noqueue state UNKNOWN group default qlen "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1/8 scope "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" lo\n       valid_lft forever preferred_lft forever\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v(": eth0@if51: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("BROADCAST,MULTICAST,UP,LOWER_UP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc noqueue state UP group default\n    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff\n    inet "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.2/16 brd "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".255.255 scope global eth0\n       valid_lft forever preferred_lft forever\n")])])]),t("p",[s._v("我们可以看到host上"),t("code",[s._v("51: vethd93e2ad@if50")]),s._v("对应着容器中"),t("code",[s._v("50: eth0@if51")]),s._v("; 即host中index=51的接口/网卡vethd93e2ad的peer inferface index是50, container中index=50的网卡eth0的peer interface index是51。")]),s._v(" "),t("p",[s._v("可以利用ethtool来确认这种对应关系：分别在host和container中运行指令"),t("code",[s._v("ethtool -S <interface>")]),s._v(":")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ethtool -S vethd93e2ad")]),s._v("\nNIC statistics:\n     peer_ifindex: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@pdai ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it 0ffd1092cd96 /bin/bash")]),s._v("\nroot@0ffd1092cd96:/"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ip a | grep 50")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v(": eth0@if51: "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("BROADCAST,MULTICAST,UP,LOWER_UP"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc noqueue state UP group default\nroot@0ffd1092cd96:/"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])])]),t("h2",{attrs:{id:"多物理机之间互联"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#多物理机之间互联"}},[s._v("#")]),s._v(" "),t("a",{attrs:{href:"#%E5%A4%9A%E7%89%A9%E7%90%86%E6%9C%BA%E4%B9%8B%E9%97%B4%E4%BA%92%E8%81%94"}},[s._v("#")]),s._v(" 多物理机之间互联")]),s._v(" "),t("blockquote",[t("p",[s._v("如果在企业内部应用，或者做多个物理主机的集群，可能需要将多个物理主机的容器组到一个物理网络中来，那么就需要将这个网桥桥接到我们指定的网卡上。")])]),s._v(" "),t("h3",{attrs:{id:"拓扑图"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#拓扑图"}},[s._v("#")]),s._v(" "),t("a",{attrs:{href:"#%E6%8B%93%E6%89%91%E5%9B%BE"}},[s._v("#")]),s._v(" 拓扑图")]),s._v(" "),t("p",[s._v("主机 A 和主机 B 的网卡一都连着物理交换机的同一个 vlan 101,这样网桥一和网桥三就相当于在同一个物理网络中了，而容器一、容器三、容器四也在同一物理网络中了，他们之间可以相互通信，而且可以跟同一 vlan 中的其他物理机器互联。")]),s._v(" "),t("p",[t("img",{attrs:{src:a(335),alt:"img"}})]),s._v(" "),t("h3",{attrs:{id:"ubuntu-示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ubuntu-示例"}},[s._v("#")]),s._v(" "),t("a",{attrs:{href:"#ubuntu-%E7%A4%BA%E4%BE%8B"}},[s._v("#")]),s._v(" ubuntu 示例")]),s._v(" "),t("p",[s._v("下面以 ubuntu 为例创建多个主机的容器联网: 创建自己的网桥,编辑 /etc/network/interface 文件")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("auto br0\niface br0 inet static\naddress "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".7.31\nnetmask "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("255.255")]),s._v(".240.0\ngateway "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".7.254\nbridge_ports em1\nbridge_stp off\ndns-nameservers "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.8")]),s._v(".8.8 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".6.1\n")])])]),t("p",[s._v("将 Docker 的默认网桥绑定到这个新建的 br0 上面，这样就将这台机器上容器绑定到 em1 这个网卡所对应的物理网络上了。")]),s._v(" "),t("p",[s._v("ubuntu 修改 /etc/default/docker 文件，添加最后一行内容")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Docker Upstart and SysVinit configuration file")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Customize location of Docker binary (especially for development testing).")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#DOCKER="/usr/local/bin/docker"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Use DOCKER_OPTS to modify the daemon startup options.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#DOCKER_OPTS="--dns 8.8.8.8 --dns 8.8.4.4"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# If you need Docker to use an HTTP proxy, it can also be specified here.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#export http_proxy="http://127.0.0.1:3128/"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# This is also a handy place to tweak where Docker's temporary files go.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#export TMPDIR="/mnt/bigdrive/docker-tmp"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DOCKER_OPTS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-b=br0"')]),s._v("\n")])])]),t("p",[s._v("在启动 Docker 的时候 使用 -b 参数 将容器绑定到物理网络上。重启 Docker 服务后，再进入容器可以看到它已经绑定到你的物理网络上了。")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@pdai:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                        NAMES\n58b043aa05eb        desk_hz:v1          "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/startup.sh"')]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" days ago          Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" seconds        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5900")]),s._v("/tcp, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6080")]),s._v("/tcp, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp   yanlx\nroot@pdai:~"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# brctl show")]),s._v("\nbridge name     bridge "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("               STP enabled     interfaces\nbr0             "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(".7e6e617c8d53       no              em1\n                                            vethe6e5\n")])])]),t("p",[s._v("这样就直接把容器暴露到物理网络上了，多台物理主机的容器也可以相互联网了。需要注意的是，这样就需要自己来保证容器的网络安全了。")]),s._v(" "),t("p",[s._v("具体步骤，还可以看下这篇文章："),t("a",{attrs:{href:"https://blog.csdn.net/gavinkelland/article/details/77976815",target:"_blank",rel:"noopener noreferrer"}},[s._v("CentOS Docker跨宿主机通讯Open vSwitch"),t("OutboundLink")],1)]),s._v(" "),t("hr"),s._v(" "),t("p",[s._v("著作权归@pdai所有 原文链接：https://pdai.tech/md/devops/docker/docker-07-network.html")])])}),[],!1,null,null,null);t.default=e.exports}}]);